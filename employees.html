<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employees List</title>
    <link rel="stylesheet" href="estilo.css">
</head>
<body>

    <nav>
        <div class="logo">Employees</div>
        <div class="nav-links">
            <a href="index.html">Add</a>
            <a href="employees.html" class="active">Employees</a>
            <a href="#" class="btn-contact">Contact</a>
        </div>
    </nav>

    <main>
        <section class="cards-container">
            </section>
    </main>

    <footer>
        All rights reserved.
    </footer>

    <script>
        const container = document.querySelector('.cards-container');
        const portaApi = "7083"; // VERIFIQUE SE SUA PORTA Ã‰ ESTA

        async function carregarFuncionarios() {
            try {
                const response = await fetch(`https://localhost:${portaApi}/api/Funcionarios`);
                const lista = await response.json();

                container.innerHTML = "";

                lista.forEach(func => {
                    const card = `
                        <div class="card">
                            <div class="card-id">${func.id}</div>
                            <h3>${func.nome}</h3>
                            <div class="card-details">${func.pais}, ${func.idade} years old</div>
                            <div class="card-job">${func.trabalho}</div>
                            <div class="card-wage">Wage: ${func.salarioAnual}</div>
                            <div class="card-actions">
                                <button class="btn-action" onclick="irParaEditar(${func.id})">Edit</button>
                                <button class="btn-action" onclick="deletar(${func.id})">Delete</button>
                            </div>
                        </div>`;
                    container.innerHTML += card;
                });
            } catch (error) {
                console.error("Erro ao carregar API:", error);
                container.innerHTML = "<p>Could not connect to the API. Make sure it's running in Visual Studio.</p>";
            }
        }

        function irParaEditar(id) {
            localStorage.setItem('idParaEditar', id);
            window.location.href = "index.html";
        }

        async function deletar(id) {
            if (confirm("Are you sure you want to delete this employee?")) {
                const response = await fetch(`https://localhost:${portaApi}/api/Funcionarios/${id}`, {
                    method: 'DELETE'
                });
                if (response.ok) {
                    carregarFuncionarios();
                }
            }
        }

        // Inicia a listagem
        carregarFuncionarios();
    </script>
</body>
</html>